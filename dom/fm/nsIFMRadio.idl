/* This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this file,
 * You can obtain one at http://mozilla.org/MPL/2.0/. */

#include "nsIDOMEventTarget.idl"

[scriptable, uuid(43e8033c-6560-4cd8-9681-2ceb660c461e)]
interface nsIFMRadioSettings : nsISupports
{
    /* Upper limit in KHz */
    attribute long upperLimit;
    /* Lower limit in KHz */
    attribute long lowerLimit;
    /* Channel width in KHz */
    attribute long channelWidth;
};

/**
 * This is an interface to expose the FM radio hardware related functions;
 * it's kind of the FM radio hardware wrapper interface.
 *
 * Because the WebFM API (navigator.mozFMRadio) is implemented as a JS component,
 * it can't access our C++ hardware interface directly; instead it must go
 * through this interface.
 * Do not confuse this interface with the WebFM DOM interface (nsIDOMFMRadio).
 *
 * If the WebFM API is re-written in c++ some day, this interface will be useless.
 */
[scriptable, builtinclass, uuid(571b660e-bd11-4b92-a6a6-885d4c00abaa)]
interface nsIFMRadio : nsIDOMEventTarget {
    const long SEEK_DIRECTION_UP   = 0;
    const long SEEK_DIRECTION_DOWN = 1;

    /**
     * Indicates if the FM radio hardware is enabled.
     */
    readonly attribute boolean enabled;

    /**
     * Current frequency in KHz
     */
    readonly attribute long frequency;

    /**
     * Indicates if the antenna is plugged in and available.
     */
    readonly attribute boolean isAntennaAvailable;

    /**
     * Indicates if the FM Radio is muted or not.
     */
    attribute boolean audioEnabled;

    /**
     * Enable the FM radio hardware with the given settings.
     */
    void enable(in nsIFMRadioSettings settings);

    /**
     * Disable the FM radio hardware.
     */
    void disable();

    /**
     * Seek the next available channel (up or down).
     *
     * @param direction
     *   The value should be one of SEEK_DIRECTION_DOWN and SEEK_DIRECTION_UP
     */
    void seek(in long direction);

    /**
     * Cancel the seek action.
     */
    void cancelSeek();

    /**
     * Get the current settings.
     */
    nsIFMRadioSettings getSettings();

    /**
     * Set the frequency in KHz
     */
    void setFrequency(in long frequency);

    /**
     * Update the visibility state of our client.
     */
    void updateVisible(in boolean visible);

    /**
     * Fired when the antenna state is changed.
     */
    [implicit_jscontext] attribute jsval onantennastatechange;

    /**
     * Fired when a seek action completes.
     */
    [implicit_jscontext] attribute jsval onseekcomplete;

    /**
     * Fired when the FM radio hardware is enabled.
     */
    [implicit_jscontext] attribute jsval onenabled;

    /**
     * Fired when the FM radio hardware is disabled.
     */
    [implicit_jscontext] attribute jsval ondisabled;
};

